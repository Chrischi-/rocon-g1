var _=require("underscore"),assert=require("assert"),crypto=require("crypto"),ApiKeyRepository=function(a){assert(a),this.dataHandler=a,this.data=a.read("apikey"),_.bindAll(this)};ApiKeyRepository.prototype.findBy=function(a,b){var c=_.where(this.data,a);b(c)},ApiKeyRepository.prototype.create=function(a,b,c){var d=crypto.createHash("sha256").update(Math.random().toString()).digest("hex");this.data.push({key:d,description:b,user:a});var e=this;this.dataHandler.write("apikey",this.data,function(a){c(a,_.where(e.data,{key:d}))})},ApiKeyRepository.prototype["delete"]=function(a,b){this.data=_.filter(this.data,function(b){return b.key!=a}),this.dataHandler.write("apikey",this.data,function(a){b(a)})},module.exports=ApiKeyRepository;